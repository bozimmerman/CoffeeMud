{
   "name":"GMCPView",
   "version":2,
   "requires":"3.2.0",
   "mxp":"",
   "triggers":[
      
   ],
   "menus":{
      "Help":[
         {
            "n":"GMCPView Plugin",
            "a":"win.sendPlugin('GMCPView','Help');"
         }
      ]
   },
   "aliases":[
      {
         "name":"SendGMCP",
         "regex":true,
         "replace":"",
         "pattern":"\\/gmcp (.*)",
         "action":"win.sendPlugin('GMCPView','&match1;');"
      }
   ],
   "timers":[
      
   ],
   "code":"viewon = false;\n\nfunction showHelp()\n{\n\twin.displayText('<FRAME GMCPHELP SCROLLING=y TITLE=\"GMCP Help\" ACTION=OPEN FLOATING=close SCROLLING=y TOP=10% LEFT=15% WIDTH=450 HEIGHT=250>');\n\tvar html = '<DEST NAME=GMCPHELP EOF><FONT COLOR=WHITE>';\n\thtml += 'This plugin requires an active connection to a MUD with GMCP enabled.<BR><BR>';\n\thtml += 'Enter <B>/gmcp [command] [json]</B> to send a GMCP command.<BR>';\n\thtml += 'For example: /gmcp core.supports.add [&quot;room.info 1&quot;]<BR><BR>';\n\thtml += 'Enter <B>/gmcp on</B> to display GMCP data as it is received.<BR><BR>';\n\thtml += 'Enter <B>/gmcp off</B> to disable GMCP display.<BR><BR>';\n\twin.displayAt(html,'GMCPHELP');\n}\n\nwindow.onevent=function(event)\n{\n\tif((event.type==='gmcp')&&(viewon))\n\t{\n\t\tif(!viewon)\n\t\t\treturn;\n\t\twin.displayText('<BR><FONT COLOR=WHITE><B>'+event.command+'</B></FONT><BR>'+JSON.stringify(event.data,null,2))\n\t\treturn;\n\t}\n\tif(event.data && event.data.toLowerCase)\n\t{\n\t\tif(event.data === 'Help')\n\t\t{\n\t\t\tshowHelp();\n\t\t\treturn;\n\t\t}\n\t\telse\n\t\tif(event.data.toLowerCase() == 'on')\n\t\t{\n\t\t\tif(viewon)\n\t\t\t\twin.displayText('<BR><FONT COLOR=WHITE>GMCP View is already on.</FONT><BR>');\n\t\t\telse\n\t\t\t\twin.displayText('<BR><FONT COLOR=WHITE>GMCP View is now ON.</FONT><BR>');\n\t\t\tviewon = true;\n\t\t\treturn;\n\t\t}\n\t\tif(event.data.toLowerCase() == 'off')\n\t\t{\n\t\t\tif(!viewon)\n\t\t\t\twin.displayText('<BR><FONT COLOR=WHITE>GMCP View is already off.</FONT><BR>');\n\t\t\telse\n\t\t\t\twin.displayText('<BR><FONT COLOR=WHITE>GMCP View is now OFF.</FONT><BR>');\n\t\t\tviewon = false;\n\t\t\treturn;\n\t\t}\n\t\tif(!event.type)\n\t\t\treturn;\n\t\tif(event.type !== 'event')\n\t\t\treturn;\n\t\tvar x = event.data.indexOf(' ');\n\t\tif(x<0)\n\t\t{\n\t\t\tevent.data += ' {}'\n\t\t\tx = event.data.indexOf(' ');\n\t\t}\n\t\tvar cmd = event.data.substr(0,x);\n\t\tvar json = event.data.substr(x+1)\n\t\twin.displayText('<BR><FONT COLOR=WHITE>Sent GMCP Command: ' + event.data+'</FONT><BR>');\n\t\twin.sendGMCP(cmd,json);\n\t}\n};\n"
}