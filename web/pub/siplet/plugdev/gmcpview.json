{
   "name":"GMCPView",
   "version":1,
   "requires":"3.2.0",
   "mxp":"",
   "triggers":[
      
   ],
   "menus":{
      "Help":[
         {
            "n":"GMCPView Plugin",
            "a":"win.sendPlugin('GMCPView','Help');"
         }
      ]
   },
   "aliases":[
      {
         "name":"SendGMCP",
         "regex":true,
         "replace":"",
         "pattern":"\\/gmcp (.*)",
         "action":"win.sendPlugin('GMCPView','&match1;');"
      }
   ],
   "timers":[
      
   ],
   "code":"viewon = false;\r\n\r\nfunction showHelp()\r\n{\r\n\twin.displayText('<FRAME GMCPHELP SCROLLING=y TITLE=\"GMCP Help\" ACTION=OPEN FLOATING=close SCROLLING=y TOP=10% LEFT=15% WIDTH=450 HEIGHT=250>');\r\n\tvar html = '<DEST NAME=GMCPHELP EOF><FONT COLOR=WHITE>';\r\n\thtml += 'This plugin requires an active connection to a MUD with GMCP enabled.<BR><BR>';\r\n\thtml += 'Enter <B>\/gmcp [command] [json]<\/B> to send a GMCP command.<BR>';\r\n\thtml += 'For example: \/gmcp core.supports.add [&quot;room.info 1&quot;]<BR><BR>';\r\n\thtml += 'Enter <B>\/gmcp on<\/B> to display GMCP data as it is received.<BR><BR>';\r\n\thtml += 'Enter <B>\/gmcp off<\/B> to disable GMCP display.<BR><BR>';\r\n\twin.displayAt(html,'GMCPHELP');\r\n}\r\n\r\nwindow.onevent=function(event)\r\n{\r\n\tif((event.type==='gmcp')&&(viewon))\r\n\t{\r\n\t\tif(!viewon)\r\n\t\t\treturn;\r\n\t\twin.displayText('<BR><FONT COLOR=WHITE><B>'+event.command+'<\/B><\/FONT><BR>'+JSON.stringify(event.data,null,2))\r\n\t\treturn;\r\n\t}\r\n\tif(event.data && event.data.toLowerCase)\r\n\t{\r\n\t\tif(event.data === 'Help')\r\n\t\t{\r\n\t\t\tshowHelp();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\telse\r\n\t\tif(event.data.toLowerCase() == 'on')\r\n\t\t{\r\n\t\t\tif(viewon)\r\n\t\t\t\twin.displayText('<BR><FONT COLOR=WHITE>GMCP View is already on.<\/FONT><BR>');\r\n\t\t\telse\r\n\t\t\t\twin.displayText('<BR><FONT COLOR=WHITE>GMCP View is now ON.<\/FONT><BR>');\r\n\t\t\tviewon = true;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(event.data.toLowerCase() == 'off')\r\n\t\t{\r\n\t\t\tif(!viewon)\r\n\t\t\t\twin.displayText('<BR><FONT COLOR=WHITE>GMCP View is already off.<\/FONT><BR>');\r\n\t\t\telse\r\n\t\t\t\twin.displayText('<BR><FONT COLOR=WHITE>GMCP View is now OFF.<\/FONT><BR>');\r\n\t\t\tviewon = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar x = event.data.indexOf(' ');\r\n\t\tif(x<0)\r\n\t\t{\r\n\t\t\tevent.data += ' {}'\r\n\t\t\tx = event.data.indexOf(' ');\r\n\t\t}\r\n\t\tvar cmd = event.data.substr(0,x);\r\n\t\tvar json = event.data.substr(x+1)\r\n\t\twin.displayText('<BR><FONT COLOR=WHITE>Sent GMCP Command: ' + event.data+'<\/FONT><BR>');\r\n\t\twin.sendGMCP(cmd,json);\r\n\t}\r\n};\r\n"
}