<DIV ID="HELPROOT">
<h3>Scripts</h3>
An Script is a named bit of free-form javascript code that can be triggered
by an <a href="javascript:menuHelp('Actions')">Action</a> taken by a Trigger,
Timer, or Alias. 
<P>
Like other editors, you can customize your global Scripts from the 
Global Options/Scripts menu, or customize the Scripts that apply only 
to the active mud window's phonebook entry through the Window/Scripts menu.
<P>
The top list field in the Scripts editor allows you to either begin adding a new
script, or editing or deleting an existing one from the list.  When adding or 
editing an entry, Red fields will denote those with invalid or missing data. 
Changes to an Script will not be submitted so long as a Red field exists. The fields are
as follows:<BR>
<UL>
<LI>Name: The unique name of your Script.  If a phonebook script name collides with 
a global script name, then the phonebook one will be preferred.</LI>
<LI>Script: The Javascript to execute.  Entities/Variables may be included in strings
in scripts in the form '&amp;varname;'.</LI>
</UL>
<h3>Useful Variables <FONT COLOR=YELLOW>(Not available to plugins)</FONT></h3>

<table border=1 style="color:white;font-size:12;">
<thead>
<tr><td>Variable</td><td>Description</td></tr>
</thead>
<tbody style="font-size:12px;color:white;">
<tr><td style="font-family:monospace;">window.siplets</td><td>Array of all window managers</td></tr>
<tr><td style="font-family:monospace;">win</td><td>Current active window manager</td></tr>
<tr><td style="font-family:monospace;">window.currWin</td><td>Current active window manager</td></tr>
<tr><td style="font-family:monospace;">win.pb</td><td>Phonebook or connection info</td></tr>
<tr><td style="font-family:monospace;">win.pb.account</td><td>True if accounts are used</td></tr>
<tr><td style="font-family:monospace;">win.pb.name</td><td>Mud name</td></tr>
<tr><td style="font-family:monospace;">win.pb.host</td><td>Mud host (Electron only)</td></tr>
<tr><td style="font-family:monospace;">win.pb.port</td><td>Mud port</td></tr>
<tr><td style="font-family:monospace;">win.pb.accountName</td><td>Account name  (Phonebook only</td></tr>
<tr><td style="font-family:monospace;">win.pb.user</td><td>Character name (Phonebook only)</td></tr>
<tr><td style="font-family:monospace;">win.pb.password</td><td>Password (Phonebook only</td></tr>
<tr><td style="font-family:monospace;">win.MSPsupport</td><td>Whether <a href="javascript:menuHelp('Msp')">MSP</a> is active</td></tr>
<tr><td style="font-family:monospace;">win.MSDPsupport</td><td>Whether MSDP is active</td></tr>
<tr><td style="font-family:monospace;">win.GMCPsupport</td><td>Whether <a href="javascript:menuHelp('Gmcp')">GMCP</a> is active</td></tr>
<tr><td style="font-family:monospace;">win.MXPsupport</td><td>Whether MXP is active</td></tr>
<tr><td style="font-family:monospace;">win.MCCPsupport</td><td>Whether MCCP is active</td></tr>
<tr><td style="font-family:monospace;">win.wsopened</td><td>Whether connection is active</td></tr>
<tr><td style="font-family:monospace;">win.windowName</td><td>Window/Connection name</td></tr>
<tr><td style="font-family:monospace;">win.topContiner.firstChild</td><td>DIV of top/first window</td></tr>
<tr><td style="font-family:monospace;">win.window</td><td>DIV of current/active frame</td></tr>
</tbody>
</table>
<h3>Useful Functions</h3>
<table border=1 style="color:white;font-size:12;">
<thead>
<tr><td>Function</td><td>Description</td></tr>
</thead>
<tbody style="font-size:12px;color:white;">
<tr><td style="font-family:monospace;">win.process(str)</td><td>Process MXP/Entities without display</td></tr>
<tr><td style="font-family:monospace;">win.submitInput(str)</td><td>Submit command to the mud</td></tr>
<tr><td style="font-family:monospace;">win.displayText(str)</td><td>Display Text in active window</td></tr>
<tr><td style="font-family:monospace;">win.playSound(str)</td><td>Play wav file named or url str</td></tr>
<tr><td style="font-family:monospace;">win.setEntity(str,str)</td><td>Set entity key to value</td></tr>
<tr><td style="font-family:monospace;">win.getEntity(str)</td><td>Get entity value</td></tr>
<tr><td style="font-family:monospace;">win.runScript(str)</td><td>Run script by name</td></tr>
<tr><td style="font-family:monospace;">win.enableTrigger(str)</td><td>Enable Trigger</td></tr>
<tr><td style="font-family:monospace;">win.disableTrigger(str)</td><td>Disable Trigger</td></tr>
<tr><td style="font-family:monospace;">win.isConnected()</td><td>Whether connection is active</td></tr>
<tr><td style="font-family:monospace;">win.displayAt(str,str)</td><td>Display string in MXP frame str(2)</td></tr>
<tr><td style="font-family:monospace;">win.clearWindow(str)</td><td>Clear window or MXP frame str</td></tr>
<tr><td style="font-family:monospace;">win.sendPlugin(str,str)</td><td>Send to plugin str, json doc str(2)</td></tr>
<tr><td style="font-family:monospace;">win.sendGMCP(str,str)</td><td>Send <a href="javascript:menuHelp('Gmcp')">GMCP</a> command str + json doc str(2)</td></tr>
<tr><td style="font-family:monospace;">win.sendMSDP(str,str)</td><td>Send msdp json doc str</td></tr>
<tr><td style="font-family:monospace;">win.submitHidden(str)</td><td>Submit hidden text to the mud</td></tr>
<tr><td style="font-family:monospace;">win.addTempTimer(obj)</td><td>Submit temp timer object (see <a href="javascript:menuHelp('Plugin')">#timer</a>)</td></tr>
<tr><td style="font-family:monospace;">win.removeTempTimer(str)</td><td>Remove temp timer by name</td></tr>
<tr><td style="font-family:monospace;">win.addTempTrigger(obj)</td><td>Submit temp trigger object (see <a href="javascript:menuHelp('Plugin')">#trigger</a>)</td></tr>
<tr><td style="font-family:monospace;">win.removeTempTrigger(str)</td><td>Remove temp trigger by name</td></tr>
<tr><td style="font-family:monospace;">win.addTempAlias(obj)</td><td>Submit temp alias object (see <a href="javascript:menuHelp('Plugin')">#alias</a>)</td></tr>
<tr><td style="font-family:monospace;">win.removeTempAlias(str)</td><td>Remove temp alias by name</td></tr>
<tr><td style="font-family:monospace;">win.addTempMenu(str,obj)</td><td>Submit menu entries under str (see <a href="javascript:menuHelp('Plugin')">#menus</a>)</td></tr>
<tr><td style="font-family:monospace;">win.removeTempAlias(str)</td><td>Remove temp menu entries under str</td></tr>
<tr><td style="font-family:monospace;">win.dispatchEvent(str)</td><td>Post an event string or json obj (w/'type')</td></tr>
<tr><td style="font-family:monospace;">win.mapper.*</td><td>The visual <a href="javascript:menuHelp('Mapper')">Mapper</a> interface.</td></tr>
</tbody>
</table>
<h3>Useful Variables <FONT COLOR=YELLOW>(Available only to plugins)</FONT></h3>
<table border=1 style="color:white;font-size:12;">
<thead>
<tr><td>Variable</td><td>Description</td></tr>
</thead>
<tbody style="font-size:12px;color:white;">
<tr><td style="font-family:monospace;">window.url</td><td>Current connection url</td></tr>
<tr><td style="font-family:monospace;">window.localStorage</td><td>Media storage</td></tr>
<tr><td style="font-family:monospace;">window.name<td>Plugin JSON field</td></tr>
<tr><td style="font-family:monospace;">window.version<td>Plugin JSON field</td></tr>
<tr><td style="font-family:monospace;">window.requires<td>Plugin JSON field</td></tr>
<tr><td style="font-family:monospace;">window.code<td>Plugin JSON field</td></tr>
<tr><td style="font-family:monospace;">window.mxp<td>Plugin JSON field</td></tr>
<tr><td style="font-family:monospace;">window.triggers<td>Plugin JSON field</td></tr>
<tr><td style="font-family:monospace;">window.aliases<td>Plugin JSON field</td></tr>
<tr><td style="font-family:monospace;">window.timers<td>Plugin JSON field</td></tr>
<tr><td style="font-family:monospace;">window.menus<td>Plugin JSON field</td></tr>
</tbody>
</table>
<h3>Special events</h3>
Scripts can also listen for special events from <a href="javascript:menuHelp('Gmcp')">GMCP</a> or MSDP.
<pre>
win.addEventListener('gmcp', function(e) {
	console.log('Got GMCP command ' + e.command + ' with data ' + JSON.stringify(e.data));
});
win.sendGMCP("core_hello", {"client":"Siplet","version":''+win.siplet.VERSION_MAJOR});
</pre>
<pre>
win.addEventListener('msdp', function(e) {
	console.log('Got MSDP data ' + JSON.stringify(e.data));
});
</pre>

</DIV>